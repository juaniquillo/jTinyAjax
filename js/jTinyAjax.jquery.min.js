(function(a){a.fn.jTinyAjax=function(b){var c={url:"",typeRequest:"post",tinymceinit:{theme:"advanced",mode:"exact",theme_advanced_buttons1:"bold,italic,underline,strikethrough,|,justifyleft,justifycenter,justifyright,justifyfull,|,formatselect, removeformat",theme_advanced_buttons2:"",theme_advanced_toolbar_location:"top",theme_advanced_toolbar_align:"left",theme_advanced_statusbar_location:"bottom",theme_advanced_resizing:true},extraParam:"",buttonTextEdit:"save",buttonTextCancel:"cancel",UIfy:false,blockUI:false,blockOptions:{message:'<img src="images/ajax-loader.gif" />',overlayCSS:{backgroundColor:"#eee",opacity:.5},css:{border:"none",backgroundColor:"transparent"},fadeIn:200,fadeOut:200},ajaxTypeData:"html",onClick:function(){},onCancel:function(){},onSend:function(){},onError:function(){},onSuccess:function(){}},d={classEdit:"editjTinyAjax",idEdit:"jTinyAjax",idEditConatiner:"jTinyAjaxContain",templateFormEd:'<form action="" class="form_edit_ad"><button class="botons_ui edit_bot_ad" onclick="return false"><span class="ui-button-text"> </span> </button><button class="botons_ui cancelar_bot_ad" onclick="return false"><span class="ui-button-text"> </span></button><input type="hidden", class="editar_hid_imp_ad" value="" /></form>',ini:function(c,e){var f=c.attr("id")||d.idEdit+"_"+e,g=d.idEditConatiner+"_"+e,h={idContainer:g,idEle:f},i=a(d.templateFormEd).hide().find(".editar_hid_imp_ad").attr("value",e+1).end();i.find(".edit_bot_ad .ui-button-text").html(b.buttonTextEdit).end().find(".cancelar_bot_ad .ui-button-text").html(b.buttonTextCancel);c.addClass(d.classEdit).attr("id",f).wrap('<div id="'+g+'" class="container_editor_ad" />').data(h).parent().append(i);if(b.UIfy){d.uiInit(h.idContainer)}},clickEdit:function(d){var e=d.data("idEle"),f=d.data("idContainer");a("#"+f).delegate(".editjTinyAjax","click",function(){var d=a("#"+e),g=d.html();a("#"+e).data({html:g});c.tinymceinit.elements=e;tinyMCE.init(b.tinymceinit);a("#"+f+" .form_edit_ad").show();b.onClick(g);return false})},send:function(c){var e=c.data("idEle"),f=c.data("idContainer"),g=a("#"+f);g.delegate(".edit_bot_ad","click",function(){var c=tinyMCE.get(e).getContent(),h={url:b.url,type:b.typeRequest,data:"data="+c+"&"+b.extraParam,dataType:b.typeData,success:function(c){if(b.ajaxTypeData==="json"){c=a.parseJSON(c);d.remove(e,f,c.editor)}else{d.remove(e,f,c)}if(b.blockUI){d.unblockInt(g)}b.onSuccess(c)},error:function(a,c){if(b.blockUI){d.unblockInt(g)}b.onError(c)}};b.onSend(c);if(b.blockUI){d.blockInt(g)}a.ajax(h)})},cancel:function(c){var e=c.data("idEle"),f=c.data("idContainer"),g;a("#"+f).delegate(".cancelar_bot_ad","click",function(){g=a("#"+e).data("html");d.remove(e,f,g);b.onCancel(g);return false})},remove:function(b,c,d){if(d!==""){tinyMCE.get(b).setContent(d)}tinyMCE.execCommand("mceRemoveControl",false,b);a(".form_edit_ad","#"+c).hide()},blockInt:function(c){if(a.fn.block){c.block(b.blockOptions)}},unblockInt:function(b){if(a.fn.unblock){b.unblock()}},uiInit:function(b){if(a.fn.button){a(".botons_ui","#"+b).button()}}};return this.each(function(){var e=a('div[id^="'+d.idEdit+'"]').length;b=a.extend(c,b);var f=a(this);d.ini(f,e);d.clickEdit(f);d.cancel(f);d.send(f)})}})(jQuery)